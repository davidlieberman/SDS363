counts <- table(clusters[[i]]$sector)
membership_proportion <- round(prop.table(counts)[which.max(counts)], 4)
new_classifications <- ifelse(clusters[[i]]$sector == names(membership_proportion), TRUE, FALSE)
names(new_classifications) <- clusters[[i]]$ticker
cluster_analytics[[i]] <- c("membership_proportion"=as.character(membership_proportion), new_classifications)
names(cluster_analytics)[i] <- paste(i,names(membership_proportion))
classifications <- c(classifications, new_classifications)
}
classifications <- classifications[order(names(classifications))]
cluster_analytics
#classifications
cat("\n")
mean(classifications)
par(mar=c(3,15,2,2))
boxplot(PC1 ~ Sectors, data=PCA_Data, horizontal = T, main="PC1 by Industry", las=2)
boxplot(PC2 ~ Sectors, data=PCA_Data, horizontal = T, main="PC2 by Industry", las=2)
boxplot(PC3 ~ Sectors, data=PCA_Data, horizontal = T, main="PC3 by Industry", las=2)
manova <- manova(as.matrix(data.LDA) ~ group.LDA)
summary.manova(manova, test="Wilks")
library(reticulate)
library(knitr)
library(MASS)
library(contrast)
library(MHTdiscrete)
reject_probability <- c()
for (j in 1:10){
m <- j*5
both_nulls_reject <- c()
for (i in 1:1000){
Control_Data <- rnorm(n=m, mean=0.4, sd=0.1)
KI_Data <- rnorm(n=m, mean=0.5, sd=0.1)
New_Drug_Data <- rnorm(n=m, mean=0.6, sd=0.1)
Proportion_Survival <- c(Control_Data, KI_Data, New_Drug_Data)
Group <- factor(rep(c("Control","KI","New_Drug"), each=m))
data <- data.frame(Proportion_Survival, Group)
model <- lm(Proportion_Survival~Group, data)
contrast1 <- contrast(model, list(Group=c("KI","New_Drug")), list(Group="Control"), type='average')
contrast2 <- contrast(model, list(Group="KI"), list(Group="New_Drug"))
pvalue <- Sidak.p.adjust(as.numeric(c(contrast1[7], contrast2[7])))
both_nulls_reject[i] <- ifelse(all(pvalue < 0.05), TRUE, FALSE)
}
reject_probability[j] <- mean(both_nulls_reject)
}
reject_probability
m <- seq(5, 50, 5)
s <- smooth.spline(m, reject_probability)
grid <- seq(1, 50, length.out = 100)
fit <- predict(s, grid)$y
plot(m, reject_probability, main="Probability both Contrasts Reject the Null", ylab="Probability", xlab="Sample Size")
lines(grid, fit, col = 4, lwd = 2)
abline(h=0.9, col=2, lwd = 2)
curve_fit_estimate <- round(grid[min(which(fit > 0.9))])
curve_fit_estimate
grid <- seq(0, 1, length.out=100)
d1 <- dbeta(grid, 10, 30)
d2 <- dbeta(grid, 15, 15)
d3 <- dbeta(grid, 12, 8)
plot(rep(grid, 3), c(d1, d2, d3), type="n", xlab="x", ylab="density",
main="Prior belief for expected proportion of cells surviving radiation")
lines(grid, d1, col=2)
lines(grid, d2, col=3)
lines(grid, d3, col=4)
legend("topright", c("control", "KI", "Osterman's"), fill=2:4)
grid <- seq(0, .025, length.out=100)
plot(grid, dgamma(grid, 10, 1000), type="l", xlab="x", ylab="density",
main="Prior belief for error variance")
reject_probability <- c()
for (j in 1:10){
m <- j*5
both_nulls_reject <- c()
for (i in 1:1000){
Error <- sqrt(mean(rgamma(m, 10, 1000)))
Control_Data <- rnorm(n=m, mean(rbeta(n=m, 10, 30)), sd=Error)
KI_Data <-  rnorm(n=m, mean(rbeta(n=m, 8, 8)), sd=Error)
New_Drug_Data <-  rnorm(n=m, mean(rbeta(n=m, 6, 4)), sd=Error)
Proportion_Survival <- c(Control_Data, KI_Data, New_Drug_Data)
Group <- factor(rep(c("Control","KI","New_Drug"), each=m))
data <- data.frame(Proportion_Survival, Group)
model <- lm(Proportion_Survival~Group, data)
contrast1 <- contrast(model, list(Group=c("KI","New_Drug")), list(Group="Control"), type='average')
contrast2 <- contrast(model, list(Group="KI"), list(Group="New_Drug"))
pvalue <- Sidak.p.adjust(as.numeric(c(contrast1[7], contrast2[7])))
both_nulls_reject[i] <- ifelse(all(pvalue < 0.05), TRUE, FALSE)
}
reject_probability[j] <- mean(both_nulls_reject)
}
reject_probability
m <- seq(5, 50, 5)
s <- smooth.spline(m, reject_probability)
model
data
reject_probability <- c()
for (j in 1:10){
m <- j*5
both_nulls_reject <- c()
for (i in 1:1000){
Error <- sqrt(mean(rgamma(m, 10, 1000)))
Control_Data <- rnorm(n=m, rbeta(1, 10, 30), sd=Error)
KI_Data <-  rnorm(n=m, rbeta(1, 8, 8), sd=Error)
New_Drug_Data <-  rnorm(n=m, rbeta(1, 6, 4), sd=Error)
Proportion_Survival <- c(Control_Data, KI_Data, New_Drug_Data)
Group <- factor(rep(c("Control","KI","New_Drug"), each=m))
data <- data.frame(Proportion_Survival, Group)
model <- lm(Proportion_Survival~Group, data)
contrast1 <- contrast(model, list(Group=c("KI","New_Drug")), list(Group="Control"), type='average')
contrast2 <- contrast(model, list(Group="KI"), list(Group="New_Drug"))
pvalue <- Sidak.p.adjust(as.numeric(c(contrast1[7], contrast2[7])))
both_nulls_reject[i] <- ifelse(all(pvalue < 0.05), TRUE, FALSE)
}
reject_probability[j] <- mean(both_nulls_reject)
}
reject_probability
contrast(model, list(Group=c("KI","New_Drug")), list(Group="Control"), type='average')
contrast(model, list(Group=c("KI","New_Drug")), list(Group="Control"), type='average')[7]
reject_probability <- c()
for (j in 1:10){
m <- j*5
both_nulls_reject <- c()
for (i in 1:1000){
Error <- sqrt(mean(rgamma(m, 10, 1000)))
Control_Data <- rnorm(n=m, rbeta(1, 10, 30), sd=Error)
KI_Data <-  rnorm(n=m, rbeta(1, 15, 15), sd=Error)
New_Drug_Data <-  rnorm(n=m, rbeta(1, 12, 8), sd=Error)
Proportion_Survival <- c(Control_Data, KI_Data, New_Drug_Data)
Group <- factor(rep(c("Control","KI","New_Drug"), each=m))
data <- data.frame(Proportion_Survival, Group)
model <- lm(Proportion_Survival~Group, data)
contrast1 <- contrast(model, list(Group=c("KI","New_Drug")), list(Group="Control"), type='average')
contrast2 <- contrast(model, list(Group="KI"), list(Group="New_Drug"))
pvalue <- Sidak.p.adjust(as.numeric(c(contrast1[7], contrast2[7])))
both_nulls_reject[i] <- ifelse(all(pvalue < 0.05), TRUE, FALSE)
}
reject_probability[j] <- mean(both_nulls_reject)
}
reject_probability
m <- seq(5, 50, 5)
s <- smooth.spline(m, reject_probability)
grid <- seq(1, 50, length.out = 100)
fit <- predict(s, grid)$y
plot(m, reject_probability, main="Probability both Contrasts Reject the Null", ylab="Probability", xlab="Sample Size")
lines(grid, fit, col = 4, lwd = 2)
abline(h=0.9, col=2, lwd = 2)
curve_fit_estimate <- round(grid[min(which(fit > 0.9))])
curve_fit_estimate
m <- seq(5, 50, 5)
s <- smooth.spline(m, reject_probability)
grid <- seq(1, 50, length.out = 100)
fit <- predict(s, grid)$y
plot(m, reject_probability, main="Probability both Contrasts Reject the Null", ylab="Probability", xlab="Sample Size")
lines(grid, fit, col = 4, lwd = 2)
abline(h=0.9, col=2, lwd = 2)
abline(h=0.9, col=2, lwd = 2)
reject_probability <- c()
for (j in 1:20){
m <- j*5
both_nulls_reject <- c()
for (i in 1:1000){
Error <- sqrt(mean(rgamma(m, 10, 1000)))
Control_Data <- rnorm(n=m, rbeta(1, 10, 30), sd=Error)
KI_Data <-  rnorm(n=m, rbeta(1, 15, 15), sd=Error)
New_Drug_Data <-  rnorm(n=m, rbeta(1, 12, 8), sd=Error)
Proportion_Survival <- c(Control_Data, KI_Data, New_Drug_Data)
Group <- factor(rep(c("Control","KI","New_Drug"), each=m))
data <- data.frame(Proportion_Survival, Group)
model <- lm(Proportion_Survival~Group, data)
contrast1 <- contrast(model, list(Group=c("KI","New_Drug")), list(Group="Control"), type='average')
contrast2 <- contrast(model, list(Group="KI"), list(Group="New_Drug"))
pvalue <- Sidak.p.adjust(as.numeric(c(contrast1[7], contrast2[7])))
both_nulls_reject[i] <- ifelse(all(pvalue < 0.05), TRUE, FALSE)
}
reject_probability[j] <- mean(both_nulls_reject)
}
reject_probability
reject_probability <- c()
for (j in 1:10){
m <- j*15
both_nulls_reject <- c()
for (i in 1:1000){
Error <- sqrt(mean(rgamma(m, 10, 1000)))
Control_Data <- rnorm(n=m, rbeta(1, 10, 30), sd=Error)
KI_Data <-  rnorm(n=m, rbeta(1, 15, 15), sd=Error)
New_Drug_Data <-  rnorm(n=m, rbeta(1, 12, 8), sd=Error)
Proportion_Survival <- c(Control_Data, KI_Data, New_Drug_Data)
Group <- factor(rep(c("Control","KI","New_Drug"), each=m))
data <- data.frame(Proportion_Survival, Group)
model <- lm(Proportion_Survival~Group, data)
contrast1 <- contrast(model, list(Group=c("KI","New_Drug")), list(Group="Control"), type='average')
contrast2 <- contrast(model, list(Group="KI"), list(Group="New_Drug"))
pvalue <- Sidak.p.adjust(as.numeric(c(contrast1[7], contrast2[7])))
both_nulls_reject[i] <- ifelse(all(pvalue < 0.05), TRUE, FALSE)
}
reject_probability[j] <- mean(both_nulls_reject)
}
reject_probability
reject_probability <- c()
for (j in 1:15){
m <- j*15
both_nulls_reject <- c()
for (i in 1:1000){
Error <- sqrt(mean(rgamma(m, 10, 1000)))
Control_Data <- rnorm(n=m, rbeta(1, 10, 30), sd=Error)
KI_Data <-  rnorm(n=m, rbeta(1, 15, 15), sd=Error)
New_Drug_Data <-  rnorm(n=m, rbeta(1, 12, 8), sd=Error)
Proportion_Survival <- c(Control_Data, KI_Data, New_Drug_Data)
Group <- factor(rep(c("Control","KI","New_Drug"), each=m))
data <- data.frame(Proportion_Survival, Group)
model <- lm(Proportion_Survival~Group, data)
contrast1 <- contrast(model, list(Group=c("KI","New_Drug")), list(Group="Control"), type='average')
contrast2 <- contrast(model, list(Group="KI"), list(Group="New_Drug"))
pvalue <- Sidak.p.adjust(as.numeric(c(contrast1[7], contrast2[7])))
both_nulls_reject[i] <- ifelse(all(pvalue < 0.05), TRUE, FALSE)
}
reject_probability[j] <- mean(both_nulls_reject)
}
reject_probability
seq(15, 225, 15)
length(seq(15, 225, 15))
reject_probability <- c()
for (j in 1:20){
m <- j*10
both_nulls_reject <- c()
for (i in 1:1000){
Error <- sqrt(mean(rgamma(m, 10, 1000)))
Control_Data <- rnorm(n=m, rbeta(1, 10, 30), sd=Error)
KI_Data <-  rnorm(n=m, rbeta(1, 15, 15), sd=Error)
New_Drug_Data <-  rnorm(n=m, rbeta(1, 12, 8), sd=Error)
Proportion_Survival <- c(Control_Data, KI_Data, New_Drug_Data)
Group <- factor(rep(c("Control","KI","New_Drug"), each=m))
data <- data.frame(Proportion_Survival, Group)
model <- lm(Proportion_Survival~Group, data)
contrast1 <- contrast(model, list(Group=c("KI","New_Drug")), list(Group="Control"), type='average')
contrast2 <- contrast(model, list(Group="KI"), list(Group="New_Drug"))
pvalue <- Sidak.p.adjust(as.numeric(c(contrast1[7], contrast2[7])))
both_nulls_reject[i] <- ifelse(all(pvalue < 0.05), TRUE, FALSE)
}
reject_probability[j] <- mean(both_nulls_reject)
}
reject_probability
reject_probability <- c()
for (j in 1:10){
m <- j*10
both_nulls_reject <- c()
for (i in 1:1000){
Error <- sqrt(rgamma(1, 10, 1000))
Control_Data <- rnorm(n=m, rbeta(1, 10, 30), sd=Error)
KI_Data <-  rnorm(n=m, rbeta(1, 15, 15), sd=Error)
New_Drug_Data <-  rnorm(n=m, rbeta(1, 12, 8), sd=Error)
Proportion_Survival <- c(Control_Data, KI_Data, New_Drug_Data)
Group <- factor(rep(c("Control","KI","New_Drug"), each=m))
data <- data.frame(Proportion_Survival, Group)
model <- lm(Proportion_Survival~Group, data)
contrast1 <- contrast(model, list(Group=c("KI","New_Drug")), list(Group="Control"), type='average')
contrast2 <- contrast(model, list(Group="KI"), list(Group="New_Drug"))
pvalue <- Sidak.p.adjust(as.numeric(c(contrast1[7], contrast2[7])))
both_nulls_reject[i] <- ifelse(all(pvalue < 0.05), TRUE, FALSE)
}
reject_probability[j] <- mean(both_nulls_reject)
}
reject_probability
reject_probability <- c()
for (j in 1:20){
m <- j*10
both_nulls_reject <- c()
for (i in 1:1000){
Error <- sqrt(rgamma(1, 10, 1000))
Control_Data <- rnorm(n=m, rbeta(1, 10, 30), sd=Error)
KI_Data <-  rnorm(n=m, rbeta(1, 15, 15), sd=Error)
New_Drug_Data <-  rnorm(n=m, rbeta(1, 12, 8), sd=Error)
Proportion_Survival <- c(Control_Data, KI_Data, New_Drug_Data)
Group <- factor(rep(c("Control","KI","New_Drug"), each=m))
data <- data.frame(Proportion_Survival, Group)
model <- lm(Proportion_Survival~Group, data)
contrast1 <- contrast(model, list(Group=c("KI","New_Drug")), list(Group="Control"), type='average')
contrast2 <- contrast(model, list(Group="KI"), list(Group="New_Drug"))
pvalue <- Sidak.p.adjust(as.numeric(c(contrast1[7], contrast2[7])))
both_nulls_reject[i] <- ifelse(all(pvalue < 0.05), TRUE, FALSE)
}
reject_probability[j] <- mean(both_nulls_reject)
}
reject_probability
m <- seq(10, 200, 10)
s <- smooth.spline(m, reject_probability)
grid <- seq(1, 50, length.out = 100)
fit <- predict(s, grid)$y
plot(m, reject_probability, main="Probability both Contrasts Reject the Null", ylab="Probability", xlab="Sample Size")
lines(grid, fit, col = 4, lwd = 2)
abline(h=0.9, col=2, lwd = 2)
curve_fit_estimate <- round(grid[min(which(fit > 0.9))])
curve_fit_estimate
m <- seq(10, 200, 10)
s <- smooth.spline(m, reject_probability)
grid <- seq(1, 200, length.out = 100)
fit <- predict(s, grid)$y
plot(m, reject_probability, main="Probability both Contrasts Reject the Null", ylab="Probability", xlab="Sample Size")
lines(grid, fit, col = 4, lwd = 2)
abline(h=0.9, col=2, lwd = 2)
curve_fit_estimate <- round(grid[min(which(fit > 0.9))])
curve_fit_estimate
m <- seq(10, 200, 10)
s <- smooth.spline(m, reject_probability)
grid <- seq(1, 200, length.out = 400)
fit <- predict(s, grid)$y
plot(m, reject_probability, main="Probability both Contrasts Reject the Null", ylab="Probability", xlab="Sample Size")
lines(grid, fit, col = 4, lwd = 2)
abline(h=0.9, col=2, lwd = 2)
curve_fit_estimate <- round(grid[min(which(fit > 0.9))])
curve_fit_estimate
?ceiling
curve_fit_estimate <- ceiling(grid[min(which(fit > 0.9))])
curve_fit_estimate
reject_probability <- c()
for (j in 1:20){
m <- j*10
both_nulls_reject <- c()
for (i in 1:1000){
Error <- sqrt(mean(rgamma(m, 10, 1000)))
Control_Data <- rnorm(n=m, mean(rbeta(n=m, 10, 30)), sd=Error)
KI_Data <-  rnorm(n=m, mean(rbeta(n=m, 8, 8)), sd=Error)
New_Drug_Data <-  rnorm(n=m, mean(rbeta(n=m, 6, 4)), sd=Error)
Proportion_Survival <- c(Control_Data, KI_Data, New_Drug_Data)
Group <- factor(rep(c("Control","KI","New_Drug"), each=m))
data <- data.frame(Proportion_Survival, Group)
model <- lm(Proportion_Survival~Group, data)
pvalue <- anova(model)$`Pr(>F)`[1]
if (pvalue < 0.05){
contrast1 <- contrast(model, list(Group=c("KI","New_Drug")), list(Group="Control"), type='average')
contrast2 <- contrast(model, list(Group="KI"), list(Group="New_Drug"))
ifelse(all(c(contrast1[7], contrast2[7]) < 0.05), both_nulls_reject[i] <- TRUE, both_nulls_reject[i] <- FALSE)
}
else{
both_nulls_reject[i] <- FALSE
}
}
reject_probability[j] <- mean(both_nulls_reject)
}
reject_probability
reject_probability <- c()
for (j in 1:20){
m <- j*10
both_nulls_reject <- c()
for (i in 1:1000){
Error <- sqrt(rgamma(1, 10, 1000))
Control_Data <- rnorm(n=m, rbeta(1, 10, 30), sd=Error)
KI_Data <-  rnorm(n=m, rbeta(1, 15, 15), sd=Error)
New_Drug_Data <-  rnorm(n=m, rbeta(1, 12, 8), sd=Error)
Proportion_Survival <- c(Control_Data, KI_Data, New_Drug_Data)
Group <- factor(rep(c("Control","KI","New_Drug"), each=m))
data <- data.frame(Proportion_Survival, Group)
model <- lm(Proportion_Survival~Group, data)
pvalue <- anova(model)$`Pr(>F)`[1]
if (pvalue < 0.05){
contrast1 <- contrast(model, list(Group=c("KI","New_Drug")), list(Group="Control"), type='average')
contrast2 <- contrast(model, list(Group="KI"), list(Group="New_Drug"))
ifelse(all(c(contrast1[7], contrast2[7]) < 0.05), both_nulls_reject[i] <- TRUE, both_nulls_reject[i] <- FALSE)
}
else{
both_nulls_reject[i] <- FALSE
}
}
reject_probability[j] <- mean(both_nulls_reject)
}
reject_probability
m <- seq(10, 200, 10)
s <- smooth.spline(m, reject_probability)
grid <- seq(1, 200, length.out = 400)
fit <- predict(s, grid)$y
plot(m, reject_probability, main="Probability both Contrasts Reject the Null", ylab="Probability", xlab="Sample Size")
lines(grid, fit, col = 4, lwd = 2)
abline(h=0.9, col=2, lwd = 2)
curve_fit_estimate <- ceiling(grid[min(which(fit > 0.9))])
curve_fit_estimate
reject_probability <- c()
for (j in 1:20){
m <- j*10
both_nulls_reject <- c()
for (i in 1:1000){
Error <- sqrt(rgamma(1, 10, 1000))
Control_Data <- rnorm(n=m, rbeta(1, 10, 30), sd=Error)
KI_Data <-  rnorm(n=m, rbeta(1, 15, 15), sd=Error)
New_Drug_Data <-  rnorm(n=m, rbeta(1, 12, 8), sd=Error)
Proportion_Survival <- c(Control_Data, KI_Data, New_Drug_Data)
Group <- factor(rep(c("Control","KI","New_Drug"), each=m))
data <- data.frame(Proportion_Survival, Group)
model <- lm(Proportion_Survival~Group, data)
contrast1 <- contrast(model, list(Group=c("KI","New_Drug")), list(Group="Control"), type='average')
contrast2 <- contrast(model, list(Group="KI"), list(Group="New_Drug"))
pvalue <- Sidak.p.adjust(as.numeric(c(contrast1[7], contrast2[7])))
both_nulls_reject[i] <- ifelse(all(pvalue < 0.05), TRUE, FALSE)
}
reject_probability[j] <- mean(both_nulls_reject)
}
reject_probability_bayesian <- reject_probability
reject_probability_bayesian
m <- seq(10, 200, 10)
s.1 <- smooth.spline(m, reject_probability_bayesian_anova)
library(reticulate)
library(knitr)
library(MASS)
library(contrast)
library(MHTdiscrete)
reject_probability <- c()
for (j in 1:20){
m <- j*10
both_nulls_reject <- c()
for (i in 1:1000){
Control_Data <- rnorm(n=m, mean=0.4, sd=0.1)
KI_Data <- rnorm(n=m, mean=0.5, sd=0.1)
New_Drug_Data <- rnorm(n=m, mean=0.6, sd=0.1)
Proportion_Survival <- c(Control_Data, KI_Data, New_Drug_Data)
Group <- factor(rep(c("Control","KI","New_Drug"), each=m))
data <- data.frame(Proportion_Survival, Group)
model <- lm(Proportion_Survival~Group, data)
contrast1 <- contrast(model, list(Group=c("KI","New_Drug")), list(Group="Control"), type='average')
contrast2 <- contrast(model, list(Group="KI"), list(Group="New_Drug"))
pvalue <- Sidak.p.adjust(as.numeric(c(contrast1[7], contrast2[7])))
both_nulls_reject[i] <- ifelse(all(pvalue < 0.05), TRUE, FALSE)
}
reject_probability[j] <- mean(both_nulls_reject)
}
reject_probability_estimate <- reject_probability
reject_probability_estimate
m <- seq(10, 200, 10)
s <- smooth.spline(m, reject_probability_estimate)
conditions <- matrix(c(1,1,
1,-1,
-1,1
-1,-1,
nrow=4, ncol=2))
conditions
conditions <- matrix(c(1,1,
1,-1,
-1,1
-1,-1), nrow=4, ncol=2)
conditions <- matrix(c(1,1,
1,-1,
-1,1,
-1,-1), nrow=4, ncol=2)
conditions
conditions <- matrix(c(1,1,
1,-1,
-1,1,
-1,-1),, ncol=2)
conditions <- matrix(c(1,1,
1,-1,
-1,1,
-1,-1),, ncol=2)
conditions
conditions <- matrix(c(1,1), nrow=1, ncol=2)
conditions
conditions <- matrix(c(1,1,-1,1), nrow=2, ncol=2)
conditions
conditions <- matrix(c(1,1,-1,1), ncol=2, nrow=2)
conditions
conditions <- matrix(c(1,-1,1,-1,1,1,-1,-1), nrow=4, ncol=2)
conditions
rep(c(c(1,0,0), c(0,1,0), c(0,0,1)), each=4)
rep(c(c(1,0,0), c(0,1,0), c(0,0,1)), times=4)
data.frame(rep(c(c(1,0,0), c(0,1,0), c(0,0,1)), times=4), rep(conditions, times=3))
rep(conditions, times=3)
conditions <- matrix(c(1,-1,1,-1,1,1,-1,-1), nrow=4, ncol=2)
rep(conditions, times=3)
rep(conditions, each=3)
drugs <- matrix(rep(c(c(1,0,0), c(0,1,0), c(0,0,1)), times=4), nrow=12, ncol=3)
drugs
drugs <- matrix(rep(c(c(1,0,0), c(0,1,0), c(0,0,1)), times=4), nrow=12, ncol=3, byrow = FALSE)
drugs
drugs <- matrix(rep(c(c(1,0,0), c(0,1,0), c(0,0,1)), times=4), nrow=12, ncol=3, byrow = TRUE)
drugs
drugs <- matrix(rep(c(c(1,0,0), c(0,1,0), c(0,0,1)), times=4), nrow=12, ncol=3, byrow=TRUE)
drugs
rep(c(c(1,0,0), c(0,1,0), c(0,0,1)), times=4)
rep(c(c(1,0,0), c(0,1,0), c(0,0,1)), 4)
drugs <- matrix(rep(c(c(1,0,0), c(0,1,0), c(0,0,1)), 4), nrow=12, ncol=3, byrow=TRUE)
drugs
drugs <- matrix(rep(c(c(1,0,0), c(0,1,0), c(0,0,1)), 4), nrow=12, ncol=3)
drugs
rep(c(c(1,0,0), c(0,1,0), c(0,0,1)), 4)
length(rep(c(c(1,0,0), c(0,1,0), c(0,0,1)), 4))
drugs <- matrix(rep(c(c(1,0,0), c(0,1,0), c(0,0,1)), 4), nrow=12, ncol=3, byrow=FALSE)
drugs
drugs <- matrix(rep(c(c(1,0,0), c(0,1,0), c(0,0,1)), 4), nrow=12, ncol=3, byrow=TRUE)
drugs
drugs <- matrix(rep(c(c(1,0,0), c(0,1,0), c(0,0,1)), 4), nrow=12, ncol=3)
drugs
drugs <- matrix(rep(c(c(1,0,0), c(0,1,0), c(0,0,1)), 4), nrow=12, ncol=3, TRUE)
drugs
drugs <- matrix(rep(c(c(1,0,0), c(0,1,0), c(0,0,1)), times=4), nrow=12, ncol=3, TRUE)
drugs
drugs <- matrix(rep(c(c(1,0,0), c(0,1,0), c(0,0,1)), each=4), nrow=12, ncol=3, TRUE)
drugs
rep(c(c(1,0,0), c(0,1,0), c(0,0,1)), times=4)
rep(c(c(1,0,0), c(0,1,0), c(0,0,1)), 4)
rep(c(1,0,0),times=4)
drugs <- matrix(c(rep(c(1,0,0),times=4),rep(c(0,1,0),times=4),rep(c(0,0,1),times=4)), nrow=12, ncol=3, TRUE)
drugs
conditions <- matrix(c(1,1,-1,1,1,-1,-1,-1), nrow=4, ncol=2, byrow=TRUE)
drugs <- matrix(c(rep(c(1,0,0),times=4),rep(c(0,1,0),times=4),rep(c(0,0,1),times=4)), nrow=12, ncol=3, byrow=TRUE)
conditions
rep(conditions, 3)
length(rep(conditions, 3))
matrix(rep(conditions, 3), nrow=12, ncol=2, byrow=TRUE)
matrix(rep(conditions, 3), nrow=12, ncol=2)
data.frame(drugs, conditions)
names(design_matrix) <- c("Control", "KI", "New_Drug", "Temperature", "Fluid")
design_matrix <- data.frame(drugs, conditions)
names(design_matrix) <- c("Control", "KI", "New_Drug", "Temperature", "Fluid")
conditions <- matrix(c(1,1,-1,1,1,-1,-1,-1), nrow=4, ncol=2, byrow=TRUE)
conditions <- matrix(rep(conditions, 3), nrow=12, ncol=2)
drugs <- matrix(c(rep(c(1,0,0),times=4),rep(c(0,1,0),times=4),rep(c(0,0,1),times=4)), nrow=12, ncol=3, byrow=TRUE)
design_matrix <- data.frame(drugs, conditions)
names(design_matrix) <- c("Control", "KI", "New_Drug", "Temperature", "Fluid")
design_matrix
